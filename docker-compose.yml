version: '3'
services:
  mongodb:
    image: mongo:3.4
    volumes:
      - /tmp/mongo:/data
  talkbot:
    build: .
    command: /bin/sh -c "python setup.py install && talk_bot run -c /srv/config.json"
    volumes:
      - .:/srv
      - /etc/letsencrypt/live/talkbot1.mediasapiens.org:/etc/certs
    links:
      - mongodb
    ports:
      - target: 443
        published: 443
        protocol: tcp
        mode: host
